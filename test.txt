main_path = os.getenv("BASE_PATH")
input_path = os.getenv("INPUTS_PATH")
data_lake_path = os.getenv("DATA_LAKE_PATH")
output_path = os.getenv("OUTPUT_PATH")

calc_dt = "20231231"
mig_mtrx_file_nm = os.path.join(data_lake_path,  "s2/IFRS9_MIGRATION_MATRICES.parquet", f"pdate={calc_dt}")
pd_vects_file_nm = os.path.join(input_path, "20230630_173_SAE_PD_VECTOR.csv")
rtgs_sorted_file_nm = os.path.join(input_path, "config/ratings_sorted.xlsx")
output_path = os.path.join(output_path, "extract_mig_mtrxs")

mig_mtrx_nms = ["CZ_CORP", "HU_CORP", "WW_GOV"]

extractor = ExtractMM(main_path=main_path, calc_dt=calc_dt, mig_mtrx_file_nm=mig_mtrx_file_nm,
                      pd_vects_file_nm=pd_vects_file_nm, rtgs_sorted_file_nm=rtgs_sorted_file_nm,
                      #output_path=output_path,
                      save=False, log_file_nm="mig.log",
                      mig_mtrx_nms=mig_mtrx_nms
                      )
